pull:
  - prefect.deployments.steps.set_working_directory:
      directory: /opt/prefect-app

deployments:
  - name: DRAP
    entrypoint: flows/d_rap_extract.py:rap_extract_flow
    work_pool:
      name: NOAA-pool
    schedules:
      - interval: 60 # 1 minute
        timezone: UTC
  
  - name: DRAP Cleanup
    entrypoint: flows/db_maintain.py:db_maintenance_flow
    work_pool:
      name: NOAA-pool
    schedules:
      - interval: 86400 # 1 day
        timezone: UTC
  
  - name: opensky-ingester
    version: null
    tags: ["ingest", "pyopensky"]
    description: "Fetches live flight data using pyopensky every 2 minutes"
    entrypoint: flows/flights_capture.py:ingest_flow
    work_pool:
      name: flight-pool
      work_queue_name: default
      job_variables: {}
    schedule:
      interval: 120

  - name: flightdata-daily-maintenance
    version: null
    tags: ["maintenance"]
    description: "Checks credit limits for changes and cleans DB"
    entrypoint: flows/flights_capture.py:maintenance_flow
    work_pool:
      name: flight-pool
      work_queue_name: default
      job_variables: {}
    # schedules:
    #   - interval: 86400 # 1 day
    #     timezone: UTC
    schedule:
      cron: "0 0 * * *"
      timezone: "UTC"